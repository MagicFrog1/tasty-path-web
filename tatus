[33m4151a7a[m[33m ([m[1;36mHEAD[m[33m -> [m[1;32mmain[m[33m, [m[1;31morigin/main[m[33m)[m Corregir errores TypeScript en nutrichat.ts - Declarar isGemini y defaultModel antes de usarlos
[33ma33f552[m Corregir tres problemas cr√≠ticos: 1) Cambiar a API nativa de Gemini con generateContent, 2) Corregir error 406 en getUserProfile usando maybeSingle, 3) Prevenir NaN en campos num√©ricos
[33m9c9540f[m Corregir autenticaci√≥n Gemini - Usar Authorization Bearer en lugar de x-goog-api-key para interfaz compatible con OpenAI
[33m6dcd624[m Corregir mensajes de error y autenticaci√≥n de Gemini - Actualizar logs para mencionar Gemini en lugar de OpenAI y corregir headers de autenticaci√≥n
[33mea2fa3c[m Migraci√≥n de OpenAI a Gemini API - Actualizado proyecto para usar Gemini en lugar de OpenAI
[33m65b9b16[m Fix: Ajustar reglas de men√∫ - reducir carne/pescado y respetar presupuesto - Cambiado de 'M√çNIMO 5 d√≠as con carne/pescado' a '1-2 d√≠as es suficiente' - Eliminadas reglas que obligan carne/pescado en cada comida - Agregadas instrucciones espec√≠ficas para respetar el presupuesto semanal (weeklyBudget) - La IA ahora debe calcular costos y ajustar ingredientes seg√∫n el presupuesto - Actualizados ejemplos para mostrar men√∫s variados con solo 1-2 d√≠as de carne/pescado - Prioriza ingredientes econ√≥micos cuando el presupuesto es bajo
[33m0f8bc79[m Fix: Arreglar problemas con CSP y TypeScript - Agregado https://api.openai.com a connect-src en CSP para permitir llamadas a OpenAI API - Corregidos errores de TypeScript en subscriptionService.ts (eliminado acceso a error.status que no existe en PostgrestError) - CSP ahora permite conexiones a OpenAI, Stripe y Supabase correctamente
[33m6e080d5[m Fix: Asegurar que usuarios gratuitos solo puedan generar 1 plan al mes - Mejorada validaci√≥n de l√≠mite mensual antes de generar - Bloqueo completo si ya gener√≥ este mes - Validaci√≥n adicional en onSubmit con mensaje claro - Mensaje mejorado en MonthlyLimitBlock - Calcula nextGenerationDate si no existe
[33m4ade7dc[m Fix: Eliminar fallback y asegurar que IA funcione para todos - Aumentados reintentos de IA de 2 a 5 intentos - generateWithSimplePrompt ahora usa IA real en lugar de fallback - Eliminado uso de fallback, solo errores claros si IA falla - Mejorada verificaci√≥n de API key para detectar sk-proj- - Timeout aumentado a 3 minutos - Todos los usuarios (premium y no premium) usan la misma IA
[33m3f8ee9d[m Revert: Volver a usar 'as any' para propiedades de Stripe Subscription - Revertida interfaz SubscriptionWithPeriods - Volviendo a la implementaci√≥n original con cast 'as any'
[33m34140e7[m Fix: Soluci√≥n type-safe para propiedades de Stripe Subscription - Creada interfaz SubscriptionWithPeriods extendiendo Stripe.Subscription - Acceso type-safe a current_period_start/end sin usar 'as any' - Resuelve errores de compilaci√≥n TypeScript en Vercel de forma elegante
[33m34e4296[m Fix: Corregir errores TypeScript en get-checkout-session y sync-subscription - Agregado cast 'as any' para acceder a propiedades de Stripe Subscription - Resuelve errores de compilaci√≥n en Vercel build
[33m8d8f975[m Fix: Restaurar api/sync-subscription.ts con export default correcto - Archivo estaba vac√≠o causando error en Vercel - Restaurada funcionalidad completa de sincronizaci√≥n - Incluye fallback a funci√≥n SQL para bypass RLS
[33mbf2b67e[m Fix: Priorizar VITE_OPENAI_API_KEY como est√° configurado en Vercel - Cambiada prioridad para usar VITE_OPENAI_API_KEY primero - Mantiene compatibilidad con NEXT_PUBLIC_OPENAI_API_KEY como fallback
[33ma44d475[m Fix: Mejorar diagn√≥stico y configuraci√≥n de API Key de OpenAI - Actualizada configuraci√≥n para buscar NEXT_PUBLIC_OPENAI_API_KEY en Vercel - Mejorado logging para diagnosticar problemas con fallback - Agregado documento de diagn√≥stico DIAGNOSTICO_FALLBACK_IA.md
